var t,e,n,r,i;!function(t){t.initializing="INITIALIZING",t.selectTask="SELECT_TASK",t.task="TASK",t.taskTimerEndPrompt="TASK_TIMER_END_PROMPT",t.shortBreak="SHORT_BREAK",t.longBreak="LONG_BREAK"}(t||(t={})),function(t){t.initializing="INITIALIZING",t.selectTask="SELECT_TASK",t.task="TASK",t.taskTimerEndPrompt="TASK_TIMER_END_PROMPT"}(e||(e={})),function(t){t.createTimer="CREATE_TIMER",t.pauseTimer="PAUSE_TIMER",t.startTimer="START_TIMER",t.tickTimer="TICK_TIMER"}(n||(n={})),function(t){t.idle="IDLE",t.ready="READY",t.active="ACTIVE",t.paused="PAUSED"}(r||(r={})),function(t){t.task="TASK",t.shortBreak="SHORT_BREAK",t.longBreak="LONG_BREAK"}(i||(i={}));const a=()=>{const t={};return{emit:(e,n)=>{var r;null===(r=t[e])||void 0===r||r.forEach((t=>t(n)))},off:(e,n)=>{const r=t[e];r&&(t[e]=r.filter((t=>t!==n)))},on:(e,n)=>{var r;const i=null!==(r=t[e])&&void 0!==r?r:[];i.push(n),t[e]=i}}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,a=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}var c;!function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"}(c||(c={}));var s={type:"xstate.init"};function u(t){return void 0===t?[]:[].concat(t)}function l(t){return{type:"xstate.assign",assignment:t}}function f(t,e){return"string"==typeof(t="string"==typeof t&&e&&e[t]?e[t]:t)?{type:t}:"function"==typeof t?{type:t.name,exec:t}:t}function m(t){return function(e){return t===e}}function d(t){return"string"==typeof t?{type:t}:t}function T(t,e){return{value:t,context:e,actions:[],changed:!1,matches:m(t)}}function p(t,e,n){var r=e,i=!1;return[t.filter((function(t){if("xstate.assign"===t.type){i=!0;var e=Object.assign({},r);return"function"==typeof t.assignment?e=t.assignment(r,n):Object.keys(t.assignment).forEach((function(i){e[i]="function"==typeof t.assignment[i]?t.assignment[i](r,n):t.assignment[i]})),r=e,!1}return!0})),r,i]}var v=function(t,e){return t.actions.forEach((function(n){var r=n.exec;return r&&r(t.context,e)}))};const g=()=>{const{emit:t,on:e,off:i}=a(),g=function(t,e){void 0===e&&(e={});var n=o(p(u(t.states[t.initial].entry).map((function(t){return f(t,e.actions)})),t.context,s),2),r=n[0],i=n[1],a={config:t,_options:e,initialState:{value:t.initial,actions:r,context:i,matches:m(t.initial)},transition:function(e,n){var r,i,c="string"==typeof e?{value:e,context:t.context}:e,s=c.value,l=c.context,v=d(n),g=t.states[s];if(g.on){var y=u(g.on[v.type]);try{for(var S=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(y),k=S.next();!k.done;k=S.next()){var x=k.value;if(void 0===x)return T(s,l);var E="string"==typeof x?{target:x}:x,h=E.target,I=E.actions,R=void 0===I?[]:I,A=E.cond,b=void 0===A?function(){return!0}:A,_=void 0===h,P=null!=h?h:s,B=t.states[P];if(b(l,v)){var K=o(p((_?u(R):[].concat(g.exit,R,B.entry).filter((function(t){return t}))).map((function(t){return f(t,a._options.actions)})),l,v),3),N=K[0],O=K[1],j=K[2],C=null!=h?h:s;return{value:C,context:O,actions:N,changed:h!==s||N.length>0||j,matches:m(C)}}}}catch(t){r={error:t}}finally{try{k&&!k.done&&(i=S.return)&&i.call(S)}finally{if(r)throw r.error}}}return T(s,l)}};return a}({initial:r.idle,context:{timer:null},states:{[r.idle]:{entry:l({timer:null}),on:{[n.createTimer]:{target:r.ready,actions:l({timer:(t,e)=>{var n;return{isInjected:null!==(n=e.payload.isInjected)&&void 0!==n&&n,time:e.payload.time,totalTime:e.payload.time,type:e.payload.type}}})}}},[r.ready]:{on:{[n.startTimer]:r.active}},[r.active]:{on:{[n.tickTimer]:[{target:r.idle,cond:t=>1===t.timer.time},{actions:l({timer:t=>Object.assign(Object.assign({},t.timer),{time:t.timer.time-1})})}],[n.pauseTimer]:r.paused}},[r.paused]:{on:{[n.startTimer]:r.active}}}}),y=function(t){var e=t.initialState,n=c.NotStarted,r=new Set,i={_machine:t,send:function(i){n===c.Running&&(e=t.transition(e,i),v(e,d(i)),r.forEach((function(t){return t(e)})))},subscribe:function(t){return r.add(t),t(e),{unsubscribe:function(){return r.delete(t)}}},start:function(r){if(r){var a="object"==typeof r?r:{context:t.config.context,value:r};e={value:a.value,actions:[],context:a.context,matches:m(a.value)}}return n=c.Running,v(e,s),i},stop:function(){return n=c.Stopped,r.clear(),i},get state(){return e},get status(){return n}};return i}(g);let S=y.state;y.subscribe((e=>{e.changed&&(S.value!==e.value&&(t("transition",{state:e,prevState:S}),S=e),t("update",e))})),y.start();return{createTimer:t=>{y.send({type:n.createTimer,payload:t})},pauseTimer:()=>{y.send({type:n.pauseTimer})},startTimer:()=>{y.send(n.startTimer)},tickTimer:()=>{y.send(n.tickTimer)},getState:()=>y.state,on:e,off:i}},y=({createTicker:e,settings:n})=>{const{emit:o,on:c,off:s}=a(),u=e(),l=function({onStateChange:e}){const{getState:n,setState:r}=function({initialState:t,context:e,onStateChange:n}){let r={value:t,context:e};return{getState:function(){return r},setState:function(t,e){r={value:null!=t?t:r.value,context:null!=e?e:r.context},n(r)}}}({initialState:t.initializing,context:{currentTaskId:null},onStateChange:e});return{handleTimerEnd:function(){r(t.taskTimerEndPrompt)},selectTask:function(e){r(t.task,{currentTaskId:e})},transitionPomodoroState:function(t){r(t)},getState:n}}({onStateChange:m}),f=g();function m(){o("update",T())}function d(){const e=n.set[0];if("task"===e)return l.getState().context.currentTaskId?(f.getState().context.timer||f.createTimer({time:n.taskTime,type:i.task}),l.transitionPomodoroState(t.task)):l.transitionPomodoroState(t.selectTask);if("shortBreak"===e)return l.transitionPomodoroState(t.shortBreak);if("longBreak"===e)return l.transitionPomodoroState(t.longBreak);throw new Error(`Unknown set item: "${e}"`)}function T(){const t=l.getState(),e=f.getState(),n=e.context.timer?{isActive:e.value===r.active,isInjected:e.context.timer.isInjected,isPaused:e.value===r.paused,time:e.context.timer.time,totalTime:e.context.timer.totalTime,type:e.context.timer.type}:null;return{value:t.value,currentTaskId:t.context.currentTaskId,timer:n}}return f.on("transition",(({state:t,prevState:e})=>{t.value===r.active?(e.value===r.ready?o("timerStart",T()):e.value===r.paused&&o("timerResume",T()),u.start((()=>{f.tickTimer(),o("timerTick",T())}))):t.value===r.idle?(u.stop(),l.handleTimerEnd(),o("timerEnd",T())):t.value===r.paused&&(u.stop(),o("timerPause",T()))})),f.on("update",m),{pauseTimer:function(){f.pauseTimer()},selectTask:function(t){l.selectTask(t),d(),o("taskSelect",T())},setReady:function(){d(),o("appInitialize",T())},startTimer:function(){f.startTimer()},getState:T,on:c,off:s}};export{y as default};
